using System.Threading;
using System.Windows.Forms;

namespace Client.Helper;

public static class Clipboard
{
	public static string GetText()
	{
		string ReturnValue = string.Empty;
		Thread thread = new Thread((ThreadStart)delegate
		{
			ReturnValue = System.Windows.Forms.Clipboard.GetText();
		});
		thread.SetApartmentState(ApartmentState.STA);
		thread.Start();
		thread.Join();
		return ReturnValue;
	}

	public static void SetText(string txt)
	{
		Thread thread = new Thread((ThreadStart)delegate
		{
			System.Windows.Forms.Clipboard.SetText(txt);
		});
		thread.SetApartmentState(ApartmentState.STA);
		thread.Start();
		thread.Join();
	}
}
